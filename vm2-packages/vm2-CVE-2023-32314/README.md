**1.Principle of the vulnerability:** 

This vulnerability mainly exists in vm2 versions below 3.9.17 and involves how to handle the proxy (Proxy) of JavaScript objects and functions in the vm module of Node.js. This vulnerability exploits the combination of the name attribute of the Error object and the *toString* method to bypass the sandbox restrictions through a proxy (Proxy) and JavaScript internal functions (such as the Function constructor).

Using this vulnerability can bypass the sandbox protections to gain remote code execution rights on the host running the sandbox.



**2.How to use this package?**

At first we publish these npm packages, but we think these packages are malicious, just publish on npm is not suitable. So we deleted these packages and publish them here. You can use them for study Javascript sandbox, but don't use them to run the real malicious code.

In this code, we can modify the command string in the *execSync* function to execute system instructions or modify 'return process' to execute other JavaScript code, enabling the execution of other malicious operations.

**3.Output and security:**

This npm package is created solely for studying sandbox escape techniques. Its execution result merely echoes "write malicious code in return process" in the terminal and does not pose a threat to system security.





